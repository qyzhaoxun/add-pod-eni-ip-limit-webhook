---
apiVersion: v1
kind: Secret
metadata:
  name: eni-ip-webhook-certs
  namespace: tke-eni-ip-webhook
type: Opaque
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUV5ekNDQTdPZ0F3SUJBZ0lVS1QvZUdDS0NFQjBaeWIxTDhjczN0RWJ2OVdrd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1pURUxNQWtHQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFVcHBibWN4RURBT0JnTlZCQWNUQjBKbAphVXBwYm1jeEREQUtCZ05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZRUURFd3ByCmRXSmxjbTVsZEdWek1CNFhEVEl3TURFeE1EQTRNREF3TUZvWERUSXhNREV3T1RBNE1EQXdNRm93WlRFTE1Ba0cKQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjBKbGFVcHBibWN4RURBT0JnTlZCQWNUQjBKbGFVcHBibWN4RERBSwpCZ05WQkFvVEEyczRjekVQTUEwR0ExVUVDeE1HVTNsemRHVnRNUk13RVFZRFZRUURFd3ByZFdKbGNtNWxkR1Z6Ck1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBOThuSXlCRXk1VkhvSGJjZlBTUDgKYm5lTGVseGQ3ZFZNU3ZlMkdoZ3ZPek51MUIyUGI1UDZMT3dsRVZDM3U2K2t4SWV0V1VMWmJWc2RCUkZBNWx0NgovWEN3dzNVZlhuYkxmd0U3a0VjSTZDelVIcUI3bnFrbTZWZU9FbVJBM0ZyZnpvcDZLWTgvbzhsSFdHZXZvYnNoCkxPUmZFczJUQVFnRGhXYnVQMWZlOHdGTEFBTWptNUVZdHkweUVyQVp6QXVRdzFiay9yOUJoRmh5Tk1NRm45aVAKSWg4TVRIZE16N09Lb01TdlV4SjdGNkR2VkpuOXl6ejUxa3IyWVQ3L0hDdDdScEU5c0Q5QzhnMG5tdVlmbmdqTApBcW1WNXprRW43SWYvUzZIMDRPRGxlNkR3YklmS0RuWWRsa0lUUG5qK0NtaUJVL05iZm5lRGd4Qks3bFVQc1ZnCi9RSURBUUFCbzRJQmNUQ0NBVzB3RGdZRFZSMFBBUUgvQkFRREFnV2dNQk1HQTFVZEpRUU1NQW9HQ0NzR0FRVUYKQndNQk1Bd0dBMVVkRXdFQi93UUNNQUF3SFFZRFZSME9CQllFRk9rejZsdTlSYlY4TVZXVzNsZnBWMGNXaUlkMQpNSUlCRndZRFZSMFJCSUlCRGpDQ0FRcUNIR0ZrWkMxd2IyUXRaVzVwTFdsd0xXeHBiV2wwTFhkbFltaHZiMnVDCkwyRmtaQzF3YjJRdFpXNXBMV2x3TFd4cGJXbDBMWGRsWW1odmIyc3VkR3RsTFdWdWFTMXBjQzEzWldKb2IyOXIKZ2pOaFpHUXRjRzlrTFdWdWFTMXBjQzFzYVcxcGRDMTNaV0pvYjI5ckxuUnJaUzFsYm1rdGFYQXRkMlZpYUc5dgpheTV6ZG1PQ08yRmtaQzF3YjJRdFpXNXBMV2x3TFd4cGJXbDBMWGRsWW1odmIyc3VkR3RsTFdWdWFTMXBjQzEzClpXSm9iMjlyTG5OMll5NWpiSFZ6ZEdWeWdrRmhaR1F0Y0c5a0xXVnVhUzFwY0Mxc2FXMXBkQzEzWldKb2IyOXIKTG5SclpTMWxibWt0YVhBdGQyVmlhRzl2YXk1emRtTXVZMngxYzNSbGNpNXNiMk5oYkljRWZ3QUFBVEFOQmdrcQpoa2lHOXcwQkFRc0ZBQU9DQVFFQVFaK3NLUlo4Z2pIa1NSK3VFaFRCRllSNVhtZzhZTnhzanBBY1lqWEJZdXlPCktnWVA0UGR0TmlVeWdydThlMjYzdmtTTzhXc25vYzBHNHZXVzg3U1BOa3hYdU5tbHRMNG1JQ1owQlBDSiszOEsKOVNzQVAzLzhSNGhSM2dyUjhSU2Z6SHN5eFVBMlcxNXIrdDhkdGJJYnBpSm5qbUxkcWFWK29TQWt6Z3Y0bFlWRwpkMUV4Qm4xYS9UekFZOUNCSGFIM1BuSGhCRi9ObHRSblZob0R2bEdPWVhHdm9oWWNoMkZjWDVwS3dXeUQxcnBICnp2dUEwQjBJaDQvRXhiMFpzS3J5aEdrUEVUb3VkMk8vdVVsaVNmUE45MVIrbHpFRW9JdnUwRnNCT2JjTU95SGgKUjY2b0EvSm1LMGZ5R2RDMkpKbExSU3FVbCszR0w0dCs3ODYyU0tPQjBnPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBOThuSXlCRXk1VkhvSGJjZlBTUDhibmVMZWx4ZDdkVk1TdmUyR2hndk96TnUxQjJQCmI1UDZMT3dsRVZDM3U2K2t4SWV0V1VMWmJWc2RCUkZBNWx0Ni9YQ3d3M1VmWG5iTGZ3RTdrRWNJNkN6VUhxQjcKbnFrbTZWZU9FbVJBM0ZyZnpvcDZLWTgvbzhsSFdHZXZvYnNoTE9SZkVzMlRBUWdEaFdidVAxZmU4d0ZMQUFNagptNUVZdHkweUVyQVp6QXVRdzFiay9yOUJoRmh5Tk1NRm45aVBJaDhNVEhkTXo3T0tvTVN2VXhKN0Y2RHZWSm45Cnl6ejUxa3IyWVQ3L0hDdDdScEU5c0Q5QzhnMG5tdVlmbmdqTEFxbVY1emtFbjdJZi9TNkgwNE9EbGU2RHdiSWYKS0RuWWRsa0lUUG5qK0NtaUJVL05iZm5lRGd4Qks3bFVQc1ZnL1FJREFRQUJBb0lCQUFmeWl1UVAyU2dOeG5vZApnM3o4aUg0cWkyaXpTYmYxSFd0U0lwOFhvM3dzbkNObGgxSTIxdEZXQ2FKU2luSVVvaDVEazhYSEpSNGl5LzE3Cm5pOUZROTZaSExKSU1XZGdQQXFveVhaSk1QbnhaaVJOVldtelZ6SW93ci9JUTJSTjdkdThDVXNIOHl5WHFoZ2wKeXpaT3dET21aMzQ4NWJna3Y2Z3BzdjZKSFBlQ1JQTitGbEROSDFSK1FYQmw1V3NMUElEdERlSHNXRW5sQ2pDYwpiWjRRcktiQUtManlTakVOcHV6QmpOYmxpZnNKYldjdFMyV3RtRStObDBBUkhHS3BlYlQ5RnNBcDJ6QVoybkltClV4djl6U0R2NmV2UDJWeFVXUEEyUjZLK2xIbmV4UlBEVFpwVEFxMGJMcHM0MkdHMmgyRzVyKzg1SVRZWlRHSE8KcDVXcHhLa0NnWUVBL09WcUxMWllaTDJYM3RKWGF2bkR1dEQ1TFpIWEpKME5qNnpKWEY1TnJIUCsvaXpXOUd3MwpVRXIvYTBVeExwMERnR1FHZ2dWdlAzaFhaamtpM0VPbXRacEZZbm9odVJaTmU5VnozQzRiZjVzRHJIejN5bHJlCkcydlVlamk3SnZIcTlWNENqYTI0akpHUGphK1pmeEhkVC8wZ3ZVdkM1b0xhY1lINDZqNStQSzhDZ1lFQSt0UlMKRzFMbVc1cGxHdWZENFNDaUE3ZzBkQlEzZms0cC9kcTNZVmN2ZE9XUDYrTlc0OHVERFByYnVXZDRkQnlxaUhFWgpuL0tBUlkyMFlQRy9oWVc0SDBESUhOTW1KSWtNa3l0cFYxOUF0SXBhVEZkSW9yM3Ira1Qyc1NuNjRKclppNlVwCmJ5M3ljQ3dzS2JLaWM3Q1pwUStheEFiTjdxQVVoZmZRVWhkL0lCTUNnWUVBNzVKVkZxNVc1bmhFMnF6Z2ExTFkKZksxaW9DeThaczd3L2Q1dGtyY3pWZDg4L0lSMXpXNkdwK1drT1haK3RPM0JWMnRxVHRuZkhYMWZMbE9LRnFkdgowakdtOFRkSm94RGhyaUh6YysycDF5UitRblRRT0Q0RWttMkFCNWlla3JJeUp1YzcvQU5LQk1BUUFlVUx3RGlvCk14SlVaWDdUejVLK1pURC9JTWk2eGJrQ2dZQVhydXlCdi9ZWU9CL0x4bzVzTjFTVTNWTzJraUliUHU0Z0ZnS3kKb2pUTTZOQUtDZEV1ZVF6S3NQVUdNSXJqQzhIZVdDOS9OcnA5MXI5dFYrWXBpVksxUUx5a1hCdUIzNTdjVm9ELwp5dktsR1ZzbFVpaDlsVWt1dkV3K3RpUUdDUmo1WW9MakNJZVhwOVFUcTlaQzdpM1R0QUY4K05lQTdJU0RrYjZOCndjSXpHUUtCZ0dSTS81ajJZS0N5R2hXbUlGTkdtTkFJb0hYRHdXU1FqNlErK2RnZzRnMzNtMkR2ckh1NnBhRWoKVE44eU9iOW9WS2pTUXRMSEJ6TGZyZXVOdmlKaE5PeU1iU3R0OVVWTUxOYTlDcnlvZW9RdzZ0Z3J2WGxveHUvVwpjOWRTZURFM0Q0RzlFdWRMQWU0aHNUZjE0MVllY2NYWWRiYVNEK2xrclJSNUk2OVh6NTFxCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
---
kind: Deployment
apiVersion: extensions/v1beta1
metadata:
  name: add-pod-eni-ip-limit-webhook
  namespace: tke-eni-ip-webhook
  labels:
    k8s-app: add-pod-eni-ip-limit-webhook
spec:
  replicas: 1
  selector:
    matchLabels:
      k8s-app: add-pod-eni-ip-limit-webhook
  template:
    metadata:
      labels:
        k8s-app: add-pod-eni-ip-limit-webhook
    spec:
      serviceAccountName: add-pod-eni-ip-limit-webhook
      containers:
      - image: ccr.ccs.tencentyun.com/tkeimages/add-pod-eni-ip-limit-webhook:v0.0.3
        args: ["--tls-cert-file=/webhook.local.config/certificates/tls.crt", "--tls-private-key-file=/webhook.local.config/certificates/tls.key", "--alsologtostderr", "-v=4", "2>&1"]
        imagePullPolicy: Always
        name: add-pod-eni-ip-limit-webhook
        volumeMounts:
        - mountPath: /webhook.local.config/certificates
          name: webhook-certs
          readOnly: true
      volumes:
      - name: webhook-certs
        secret:
          secretName: eni-ip-webhook-certs
---
apiVersion: v1
kind: Service
metadata:
  name: add-pod-eni-ip-limit-webhook
  namespace: tke-eni-ip-webhook
spec:
  type: ClusterIP
  selector:
    k8s-app: add-pod-eni-ip-limit-webhook
  ports:
  - port: 443
    targetPort: 443
    protocol: TCP